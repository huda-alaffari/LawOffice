@page "/dashboard"
@using System.Globalization

<div class="min-h-screen bg-[#f5f0e8] p-6" dir="rtl" style="font-family:'Cairo',sans-serif;">

    <!-- الهيدر -->
    <header class="flex justify-between items-center mb-6 bg-[#fffaf3] shadow rounded-3xl px-6 py-3 border border-[#d8b98b]">
        <h1 class="text-2xl font-bold text-[#4b2e0f]">لوحة إدارة مكتب المحاماة</h1>

        <div class="flex gap-3 items-center">
            <!-- زر الصلاحيات -->
            <NavLink href="/Permissions"
                     class="flex flex-col items-center text-[#4b2e0f] bg-white px-3 py-2 rounded-xl border border-[#d8b98b] hover:bg-[#f5f0e8] transition shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 15v2m0 4a2 2 0 100-4 2 2 0 000 4zm-6-4a2 2 0 104 0 2 2 0 00-4 0zm12-6a2 2 0 104 0 2 2 0 00-4 0zm-12 0a2 2 0 104 0 2 2 0 00-4 0z" />
                </svg>
                إدارة الصلاحيات
            </NavLink>
            <!-- زر العملاء -->
            <NavLink href="/Register-client"
                     class="flex flex-col items-center text-[#4b2e0f] bg-white px-3 py-2 rounded-xl border border-[#d8b98b] hover:bg-[#f5f0e8] transition shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m0 4a2 2 0 100-4 2 2 0 000 4zm-6-4a2 2 0 104 0 2 2 0 00-4 0zm12-6a2 2 0 104 0 2 2 0 00-4 0zm-12 0a2 2 0 104 0 2 2 0 00-4 0z" />
                </svg>
                تسجيل عميل جديد
            </NavLink>

            <!-- زر الإشعارات -->
            <button class="flex flex-col items-center text-[#4b2e0f] bg-white px-3 py-2 rounded-xl border border-[#d8b98b] hover:bg-[#f5f0e8] transition shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
                إشعارات (@Notifications.Count)
            </button>
        </div>
    </header>

    <!-- بطاقات الإحصائيات -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
        @foreach (var card in DashboardCards)
        {
            <div class="bg-white border border-[#d8b98b] rounded-xl shadow p-3 hover:scale-[1.02] transition-transform">
                <div class="flex justify-between items-center mb-2">
                    <div class="text-sm font-medium text-[#4b2e0f]">@card.Title</div>
                </div>
                <div class="text-2xl font-semibold text-[#3b2b1a]">@card.Value</div>
            </div>
        }
    </div>

    <!-- الجلسات و الإشعارات -->
    <section class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-white border border-[#d8b98b] rounded-xl shadow p-4">
            <h2 class="text-lg font-semibold text-[#4b2e0f] mb-3">آخر الجلسات المجدولة</h2>
            <ul class="space-y-2 text-[#3b2b1a] text-sm">
                @foreach (var s in UpcomingSessions.Take(5))
                {
                    <li>📅 @s.CaseRef - @s.Court - @s.Date.ToString("d MMMM yyyy", CultureInfo.GetCultureInfo("ar-SA"))</li>
                }
            </ul>
        </div>

        @* <div class="bg-white border border-[#d8b98b] rounded-xl shadow p-4">
            <h2 class="text-lg font-semibold text-[#4b2e0f] mb-3">الصلاحيات</h2>
            <ul class="space-y-2 text-[#3b2b1a] text-sm">
                <li>
                    <NavLink href="/Permissions" class="text-[#b9996b] hover:underline">إدارة الصلاحيات</NavLink>
                </li>
            </ul>
        </div> *@

        <div class="bg-white border border-[#d8b98b] rounded-xl shadow p-4">
            <h2 class="text-lg font-semibold text-[#4b2e0f] mb-3">الإشعارات الأخيرة</h2>
            <ul class="space-y-2 text-[#3b2b1a] text-sm">
                @foreach (var n in Notifications)
                {
                    <li>• @n.Message</li>
                }
            </ul>
        </div>
    </section>
</div>

@code {
    [Inject] NavigationManager Navigation { get; set; } = default!;

    // private void NavigateToClients()
    // {
    //     Navigation.NavigateTo("/register-client");
    // }

    private List<DashboardCard> DashboardCards = new()
    {
        new DashboardCard("عدد القضايا النشطة", 32),
        new DashboardCard("الجلسات القادمة", 8),
        new DashboardCard("العملاء المسجلون", 57),
        new DashboardCard("المستندات المضافة", 142),
    };

    private List<SessionItem> UpcomingSessions = new()
    {
        new SessionItem { CaseRef = "قضية رقم 221/2025", Court = "المحكمة العليا", Date = new DateTime(2025, 11, 4) },
        new SessionItem { CaseRef = "قضية رقم 198/2025", Court = "المحكمة التجارية", Date = new DateTime(2025, 11, 6) },
        new SessionItem { CaseRef = "قضية رقم 134/2025", Court = "المحكمة الجزائية", Date = new DateTime(2025, 11, 9) }
    };

    private List<NotificationItem> Notifications = new()
    {
        new NotificationItem { Id = 1, Message = "جلسة جديدة بتاريخ 5 نوفمبر 2025" },
        new NotificationItem { Id = 2, Message = "تم رفع مستند جديد في قضية رقم 128/2025" },
        new NotificationItem { Id = 3, Message = "دفعة مستحقة على العميل أحمد الشمري" }
    };

    private record DashboardCard(string Title, int Value);
    private class SessionItem { public string CaseRef { get; set; } = ""; public string Court { get; set; } = ""; public DateTime Date { get; set; } }
    private class NotificationItem { public int Id { get; set; } public string Message { get; set; } = ""; }
}